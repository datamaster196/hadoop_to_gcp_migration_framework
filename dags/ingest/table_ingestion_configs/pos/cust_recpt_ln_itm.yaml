database_source: pos
dataset_name: pos
table_name: cust_recpt_ln_itm
hwm_column: last_update
split_by_column: last_update
num_mappers: 6
target_dir: gs://adw-lake-pos-{ENV}/cust_recpt_ln_itm/source/{{{{ ds }}}}

query: >-
  select
    assoc_cd  ,
    clb_cd  ,
    ofc_id  ,
    sale_id ,
    cust_recpt_ln_itm_id  ,
    group_ind  ,
    source_cd  ,
    ofr_id  ,
    cust_recpt_ln_itm_inv_id  ,
    cust_recpt_ln_itm_dsc_tx  ,
    cust_recpt_ln_itm_qty_ct  ,
    cust_recpt_ln_itm_uom_cd  ,
    cust_recpt_ln_itm_chg_itm  ,
    cust_recpt_ln_itm_tax_itm  ,
    cust_recpt_vd_ret_ind ,
    cust_recpt_ret_rsn_cd ,
    cust_recpt_ln_itm_ser_nr ,
    gl_acct_nr ,
    upload_trans_nr ,
    shipping_amt ,
    shipping_qty  ,
    handling_amt ,
    handling_qty  ,
    list_prc  ,
    nonmember_prc  ,
    member_prc  ,
    employee_prc  ,
    sale_prc  ,
    special_tax_amt ,
    inv_itm_typ ,
    dynamic_typ ,
    user_string ,
    user_dt  ,
    user_dec ,
    product_incpl_ind  ,
    price_override_ind  ,
    ord_fulfillment_qty  ,
    inv_ser_id ,
    inv_sku_id ,
    last_update  ,
    inv_sku_position ,
    itm_additional_info_txt ,
    warranty_id ,
    CURRENT_TIMESTAMP as adw_lake_insert_datetime,
    {{{{ dag_run.id }}}} as adw_lake_insert_batch_number
  from [{db_name}].dbo.cust_recpt_ln_itm
  where $CONDITIONS


ddl: >-
  CREATE TABLE IF NOT EXISTS `{INGESTION_PROJECT}.pos.cust_recpt_ln_itm`(
    assoc_cd String ,
    clb_cd String ,
    ofc_id String ,
    sale_id String,
    cust_recpt_ln_itm_id String ,
    group_ind String ,
    source_cd String ,
    ofr_id String ,
    cust_recpt_ln_itm_inv_id String ,
    cust_recpt_ln_itm_dsc_tx String ,
    cust_recpt_ln_itm_qty_ct String ,
    cust_recpt_ln_itm_uom_cd String ,
    cust_recpt_ln_itm_chg_itm String ,
    cust_recpt_ln_itm_tax_itm String ,
    cust_recpt_vd_ret_ind String,
    cust_recpt_ret_rsn_cd String,
    cust_recpt_ln_itm_ser_nr String,
    gl_acct_nr String,
    upload_trans_nr String,
    shipping_amt String,
    shipping_qty String ,
    handling_amt String,
    handling_qty String ,
    list_prc String ,
    nonmember_prc String ,
    member_prc String ,
    employee_prc String ,
    sale_prc String ,
    special_tax_amt String,
    inv_itm_typ String,
    dynamic_typ String,
    user_string String,
    user_dt String ,
    user_dec String,
    product_incpl_ind String ,
    price_override_ind String ,
    ord_fulfillment_qty String ,
    inv_ser_id String,
    inv_sku_id String,
    last_update String ,
    inv_sku_position String,
    itm_additional_info_txt String,
    warranty_id String,
    adw_lake_insert_datetime datetime ,
    adw_lake_insert_batch_number int64
    ) PARTITION BY DATE(_PARTITIONTIME);