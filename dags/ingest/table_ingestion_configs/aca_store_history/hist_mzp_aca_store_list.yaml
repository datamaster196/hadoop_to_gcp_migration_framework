database_source: mzp
dataset_name: mzp
table_name: aca_store_list
hwm_column: 
split_by_column: ID
num_mappers: 4
target_dir: gs://adw-lake-eds-mzp-{ENV}/aca_store_list/source

query: >-
  select "ID",
  "MUID", 
  "VersionName",
  "VersionNumber",
  "VersionFlag",
  "Name",
  "Code",
  "ChangeTrackingMask",
  "Status",
  "Address",
  "State",
  "Phone",
  "OfficeType",
  "CarCareOfficeID",
  "InsuranceOfficeID",
  "MembershipOfficeID",
  "RetailSalesOfficeID",
  "TravelOfficeID",
  "AdminCostCenter",
  "CarCareCostCenter",
  "FacilityCostCenter",
  "InsuranceCostCenter",
  "MembershipCostCenter",
  "OccupancyCostCenter",
  "RetailSalesCostCenter",
  "TireCostCenter",
  "TravelCostCenter",
  "CarCareRegion",
  "InsuranceRegion",
  "MembershipRegion",
  "PresidentRegion",
  "RetailSalesRegion",
  "TravelRegion",
  "CarCareDistictNumber",
  "RetailDistictNumber",
  "CommCenter",
  "RM - Cost Center Manager",
  "RM - Cost Center Manager email",
  "RAM",
  "RAM email",
  "Staff Assistant",
  "Staff Assistant email",
  "Car Care Manager - Cost Center Manager",
  "Car Care Manager - Cost Center Manager email",
  "Car Car Asst Manager",
  "Car Car Asst Manager email",
  "RTSM",
  "RTSM email",
  "Retail Sales Coach",
  "Retail Sales Coach email",
  "Xactly Retail Store Number",
  "Xactly Car Care Store Number",
  "Premerger Business Line",
  "GM - Car Care",
  "GM - Car Care email",
  "Car Care Director",
  "Car Care Director email",
  "GM - Retail",
  "GM - Retail email",
  "Director District Manager",
  "Director District Manager email",
  "National ATS Number",
  "Retail Count",
  "Source",
  null as "Division",
  "EnterDateTime",
  "EnterUserName",
  "EnterVersionNumber",
  "LastChgDateTime",
  "LastChgUserName",
  "LastChgVersionNumber",
  "ValidationStatus",
  CURRENT_TIMESTAMP as adw_lake_insert_datetime,
  {{{{ dag_run.id }}}}  as adw_lake_insert_batch_number
  from  MDS.mdm.ACAStoreList
  where $CONDITIONS


ddl: >-
  CREATE TABLE IF NOT EXISTS `{INGESTION_PROJECT}.mzp.aca_store_list` (
   ID                                             STRING,
   MUID                                           STRING,
   VersionName                                    STRING,
   VersionNumber                                  STRING,
   VersionFlag                                    STRING,
   Name                                           STRING,
   Code                                           STRING,
   ChangeTrackingMask                             STRING,
   Status                                         STRING,
   Address                                        STRING,
   State                                          STRING,
   Phone                                          STRING,
   Officetype                                     STRING,
   CarCareOfficeID                                STRING,
   InsuranceOfficeID                              STRING,
   MembershipOfficeID                             STRING,
   RetailSalesOfficeID                            STRING,
   TravelOfficeID                                 STRING,
   AdminCostCenter                                STRING,
   CarCareCostCenter                              STRING,
   FacilityCostCenter                             STRING,
   InsuranceCostCenter                            STRING,
   MembershipCostCenter                           STRING,
   OccupancyCostCenter                            STRING,
   RetailSalesCostCenter                          STRING,
   TireCostCenter                                 STRING,
   TravelCostCenter                               STRING,
   CarCareRegion                                  STRING,
   InsuranceRegion                                STRING,
   MembershipRegion                               STRING,
   PresidentRegion                                STRING,
   RetailSalesRegion                              STRING,
   TravelRegion                                   STRING,
   CarCareDistrictNumber                          STRING,
   RetailDistrictNumber                           STRING,
   CommCenter                                     STRING,
   RM_Cost_Center_Manager                         STRING,
   RM_Cost_Center_Manager_Email                   STRING,
   RAM                                            STRING,
   RAM_Email                                      STRING,
   Staff_Assistant                                STRING,
   Staff_Assistant_Email                          STRING,
   Car_Care_Manager_Cost_Center_Manager           STRING,
   Care_Care_Manager_Cost_Center_Manager_Email    STRING,
   Car_Care_Asst_Manager                          STRING,
   Car_Care_Asst_Manager_Email                    STRING,
   RTSM                                           STRING,
   RTSM_Email                                     STRING,
   Retail_Sales_Coach                             STRING,
   Retail_Sales_Coach_email                       STRING,
   Xactly_Retail_Store_Number                     STRING,
   Xactly_Care_Care_Store_Number                  STRING,
   PreMerger_Business_Line                        STRING,
   GM_Car_Care                                    STRING,
   GM_Car_Care_Email                              STRING,
   Car_Care_Director                              STRING,
   Car_Care_Director_email                        STRING,
   GM_Retail                                      STRING,
   GM_Retail_Email                                STRING,
   Director_District_Manager                      STRING,
   Director_District_Manager_Email                STRING,
   National_ATS_Number                            STRING,
   Retail_Count                                   STRING,
   Source                                         STRING,
   EnterDatetime                                  STRING,
   EnterUserName                                  STRING,
   EnterVersionNumber                             STRING,
   LastChgDateTime                                STRING,
   LastChgUserName                                STRING,
   LastChgVersionNumber                           STRING,
   ValidationStatus                               STRING,
   adw_lake_insert_datetime        DATETIME,
   adw_lake_insert_batch_number    INT64)
  PARTITION BY DATE(_PARTITIONTIME)
  ;