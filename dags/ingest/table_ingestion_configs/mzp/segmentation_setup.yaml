database_source: mzp
dataset_name: mzp
table_name: segmentation_setup
hwm_column: 
split_by_column: segmentation_setup_ky
num_mappers: 2
target_dir: gs://adw-lake-mzp-{ENV}/segmentation_setup/source/{{{{ ds }}}}

query: >-
    select
     segmentation_setup_ky,
     name,
     email_on_success,
     email_on_failure,
     divisions,
     renew_method_cds,
     exclude_ebill_fl,
     status,
     commission_cds,
     rider_comp_cds,
     bill_cat_cds,
     membership_exp_dt1,
     membership_exp_dt2,
     membership_exp_dt3,
     membership_exp_dt4,
     membership_exp_dt5,
     membership_exp_dt6,
     membership_exp_dt7,
     membership_exp_dt8,
     membership_exp_dt9,
     membership_exp_dt10,
     membership_exp_dt11,
     membership_exp_dt12,
     segmentation_count_dt,
     segmentation_complete_dt,
     segmentation_schedule_dt,
     segmentation_test_end_dt,
     segmentation_sample_size,
     panel_c1,
     panel_t1,
     panel_t2,
     panel_t3,
     panel_t4,
     panel_t5,
     panel_t6,
     panel_t7,
     panel_t8,
     panel_t9,
     panel_t10,
     percentage_c1,
     percentage_t1,
     percentage_t2,
     percentage_t3,
     percentage_t4,
     percentage_t5,
     percentage_t6,
     percentage_t7,
     percentage_t8,
     percentage_t9,
     percentage_t10,
     panel_cd_t1,
     panel_cd_t2,
     panel_cd_t3,
     panel_cd_t4,
     panel_cd_t5,
     panel_cd_t6,
     panel_cd_t7,
     panel_cd_t8,
     panel_cd_t9,
     panel_cd_t10,
     segmentation_cnt_proc_ky,
     segmentation_process_ky,
     max_member_cnt,
     exclude_gift_donor_fl,
     exclude_corp_donor_fl,
     exclude_group_donor_fl,
     exclude_oot_fl,
     exclude_dnr_fl,
     panel_t11,
     panel_t12,
     panel_t13,
     panel_t14,
     panel_t15,
     panel_t16,
     panel_t17,
     panel_t18,
     panel_t19,
     panel_t20,
     percentage_t11,
     percentage_t12,
     percentage_t13,
     percentage_t14,
     percentage_t15,
     percentage_t16,
     percentage_t17,
     percentage_t18,
     percentage_t19,
     percentage_t20,
     panel_cd_t11,
     panel_cd_t12,
     panel_cd_t13,
     panel_cd_t14,
     panel_cd_t15,
     panel_cd_t16,
     panel_cd_t17,
     panel_cd_t18,
     panel_cd_t19,
     panel_cd_t20,
     membership_exp_from,
     membership_exp_to,
     SYSDATE as adw_lake_insert_datetime,
     {{{{ dag_run.id }}}} as adw_lake_insert_batch_number
     from mz_plus_212.mz_segmentation_setup
     where $CONDITIONS

ddl: >-
  CREATE TABLE IF NOT EXISTS `{INGESTION_PROJECT}.mzp.segmentation_setup` (
   segmentation_setup_ky           STRING           NOT NULL,
   name                            STRING      NOT NULL,
   email_on_success                STRING,
   email_on_failure                STRING,
   divisions                       STRING,
   renew_method_cds                STRING,
   exclude_ebill_fl                STRING,
   status                          STRING,
   commission_cds                  STRING,
   rider_comp_cds                  STRING,
   bill_cat_cds                    STRING,
   membership_exp_dt1              STRING,
   membership_exp_dt2              STRING,
   membership_exp_dt3              STRING,
   membership_exp_dt4              STRING,
   membership_exp_dt5              STRING,
   membership_exp_dt6              STRING,
   membership_exp_dt7              STRING,
   membership_exp_dt8              STRING,
   membership_exp_dt9              STRING,
   membership_exp_dt10             STRING,
   membership_exp_dt11             STRING,
   membership_exp_dt12             STRING,
   segmentation_count_dt           STRING,
   segmentation_complete_dt        STRING,
   segmentation_schedule_dt        STRING,
   segmentation_test_end_dt        STRING,
   segmentation_sample_size        STRING,
   panel_c1                        STRING,
   panel_t1                        STRING,
   panel_t2                        STRING,
   panel_t3                        STRING,
   panel_t4                        STRING,
   panel_t5                        STRING,
   panel_t6                        STRING,
   panel_t7                        STRING,
   panel_t8                        STRING,
   panel_t9                        STRING,
   panel_t10                       STRING,
   percentage_c1                   STRING,
   percentage_t1                   STRING,
   percentage_t2                   STRING,
   percentage_t3                   STRING,
   percentage_t4                   STRING,
   percentage_t5                   STRING,
   percentage_t6                   STRING,
   percentage_t7                   STRING,
   percentage_t8                   STRING,
   percentage_t9                   STRING,
   percentage_t10                  STRING,
   panel_cd_t1                     STRING,
   panel_cd_t2                     STRING,
   panel_cd_t3                     STRING,
   panel_cd_t4                     STRING,
   panel_cd_t5                     STRING,
   panel_cd_t6                     STRING,
   panel_cd_t7                     STRING,
   panel_cd_t8                     STRING,
   panel_cd_t9                     STRING,
   panel_cd_t10                    STRING,
   segmentation_cnt_proc_ky        STRING,
   segmentation_process_ky         STRING,
   max_member_cnt                  STRING,
   exclude_gift_donor_fl           STRING,
   exclude_corp_donor_fl           STRING,
   exclude_group_donor_fl          STRING,
   exclude_oot_fl                  STRING,
   exclude_dnr_fl                  STRING,
   panel_t11                       STRING,
   panel_t12                       STRING,
   panel_t13                       STRING,
   panel_t14                       STRING,
   panel_t15                       STRING,
   panel_t16                       STRING,
   panel_t17                       STRING,
   panel_t18                       STRING,
   panel_t19                       STRING,
   panel_t20                       STRING,
   percentage_t11                  STRING,
   percentage_t12                  STRING,
   percentage_t13                  STRING,
   percentage_t14                  STRING,
   percentage_t15                  STRING,
   percentage_t16                  STRING,
   percentage_t17                  STRING,
   percentage_t18                  STRING,
   percentage_t19                  STRING,
   percentage_t20                  STRING,
   panel_cd_t11                    STRING,
   panel_cd_t12                    STRING,
   panel_cd_t13                    STRING,
   panel_cd_t14                    STRING,
   panel_cd_t15                    STRING,
   panel_cd_t16                    STRING,
   panel_cd_t17                    STRING,
   panel_cd_t18                    STRING,
   panel_cd_t19                    STRING,
   panel_cd_t20                    STRING,
   membership_exp_from             STRING,
   membership_exp_to               STRING,
   adw_lake_insert_datetime        DATETIME,
   adw_lake_insert_batch_number    INT64)
    PARTITION BY DATE(_PARTITIONTIME)
  ;
